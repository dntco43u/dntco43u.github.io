[{"body":"","categories":"","description":"","excerpt":"","ref":"/","tags":"","title":"dntco43u Documentation"},{"body":"","categories":"","description":"Infrastructure 구성","excerpt":"Infrastructure 구성","ref":"/test/","tags":"","title":"Infrastructure"},{"body":"TL;DR 12 passive mode, explicit ftp over tls, rclone 호환 구성\n방화벽 구성 보안을 고려하여 21/tcp port는 임의의 6xxxx/tcp로 port forwarding command port인 6xxxx/tcp port와 data port인 6xxxx-6xxxx/tcp port를 inbound에서 허용\nsudo firewall-cmd --permanent --add-forward-port=port=6xxxx:proto=tcp:toport=21 \u0026\u0026 \\ sudo firewall-cmd --permanent --add-port=6xxxx-6xxxx/tcp \u0026\u0026 \\ sudo firewall-cmd --reload \u0026\u0026 \\ sudo firewall-cmd --list-all selinux 구성 /home directory, symbolic link, passive mode를 허용 Permissive mode인 경우에도 영향 있으므로 반드시 구성1\nsudo setsebool -P ftpd_use_passive_mode on \u0026\u0026 \\ sudo setsebool -P ftpd_full_access on 인증서 구성 acme.sh 인증서 구성 인증서 갱신 시 재시작 되도록 구성\nvsftp 설치 sudo dnf install -y vsftpd \u0026\u0026 \\ sudo systemctl enable vsftpd \u0026\u0026 \\ sudo systemctl start vsftpd \u0026\u0026 \\ sudo systemctl status vsftpd 기본 구성 백업 (Optional) sudo cp /etc/vsftpd/vsftpd.conf /etc/vsftpd/vsftpd.conf.bak \u0026\u0026 \\ sudo cp /etc/vsftpd/ftpusers /etc/vsftpd/ftpusers.bak root 접속 허용 (Optional) sudo sed -i 's/root/#root/g' /etc/vsftpd/ftpusers vsftp 구성 파일 sudo vi /etc/vsftpd/vsftpd.conf # rhel pam_service_name=vsftpd # security anonymous_enable=NO write_enable=YES local_enable=YES local_root=/ local_umask=022 userlist_enable=NO userlist_deny=NO chroot_list_enable=NO chroot_local_user=YES secure_chroot_dir=/var/empty allow_writeable_chroot=YES # passive listen=YES listen_ipv6=NO connect_from_port_20=NO pasv_enable=YES pasv_address=1xx.xxx.xxx.xxx pasv_min_port=6xxxx pasv_max_port=6xxxx # ssl rsa_cert_file=/home/dev/.acme/xxxxxxxx_ecc/fullchain.cer rsa_private_key_file=/home/dev/.acme/xxxxxxxx_ecc/xxxxxxxx.key ssl_enable=YES allow_anon_ssl=NO require_ssl_reuse=YES ssl_ciphers=HIGH ssl_sslv2=NO ssl_sslv3=NO ssl_tlsv1=NO ssl_tlsv1_1=NO ssl_tlsv1_2=YES ssl_tlsv1_3=YES # log dirmessage_enable=YES xferlog_enable=YES xferlog_std_format=YES log_ftp_protocol=YES dual_log_enable=YES # etc seccomp_sandbox=NO force_dot_files=YES idle_session_timeout=0 vsftp 구성 파일 주요 내역 구성 내역 anonymous_enable=NO 익명 접속 불가 pasv_enable=YES passive mode ssl_tlsv1/v1_1=NO tls 1.2 미만 접속 불가2 seccomp_sandbox=NO 추가 보안 계층 비활성화3 force_dot_files=YES .파일(구성 파일) 숨김 해제 idle_session_timeout=0 무제한 세션 유지4 구성 적용 sudo systemctl restart vsftpd \u0026\u0026 \\ sudo systemctl status vsftpd 구성 테스트 (Optional) rclone 구성\nremote_ftp=xxxxxxxx-ftp: \u0026\u0026 \\ rclone copy \"$remote_ftp\"/home/dev/test.sh /tmp --progress \u0026\u0026 \\ rclone delete \"$remote_ftp\"/home/dev/test.sh --progress \u0026\u0026 \\ rclone move /tmp/test.sh \"$remote_ftp\"/home/dev --progress \u0026\u0026 \\ unset remote_ftp logrotate 구성 파일 (Optional) 7일 순환 예\nsudo vi /etc/logrotate.d/vsftpd /var/log/vsftpd.log /var/log/xferlog { daily rotate 7 missingok notifempty dateext dateyesterday dateformat -%Y%m%d sharedscripts postrotate /usr/bin/systemctl restart vsftpd.service \u003e/dev/null 2\u003e\u00261 || true endscript } References https://rclone.org/ftp/ https://forum.rclone.org/t/is-encryption-ftp-explicit-over-tls-supported/30770/2 https://access.redhat.com/solutions/3436 https://wiki.gentoo.org/wiki/Vsftpd\n구성되지 않으면 rclone client에서 “local error: tls: protocol version not supported” 간헐적인 오류 발생 ↩︎\nrclone 커뮤니티에서 vsftp의 tls 1.3을 사용할 수 없다고 함. rclone 문서의 tls 1.3 비활성화 참고 –ftp-disable-tls13 Disable TLS 1.3 (workaround for FTP servers with buggy TLS) ↩︎\n기본적으로 활성화 되어 있으며 비활성화하지 않으면 rclone 등의 client에서 “Fatal error: 500 OOPS: priv_sock_get_cmd” 오류 발생 ↩︎\nkeep-alive command 구성이 없는 client의 경우 ↩︎\n","categories":["test_category"],"description":"테스트 포스트 2 - RHEL vsftp 구성에 대하여\n","excerpt":"테스트 포스트 2 - RHEL vsftp 구성에 대하여\n","ref":"/test/test_post_2/","tags":["test_tag"],"title":"vsftp 구성"},{"body":"Example CSS body { font-size: 16px; /* comment */ } Example HTML \u003ca href=\"/about.html\"\u003eExample\u003c/a\u003e \u003c!-- comment --\u003e Example Go HTML template {{ with $.Page.Params.content }} {{ . | $.Page.RenderString }} {{/* comment */}} {{ end }} Example JS if ([1,\"one\",2,\"two\"].includes(value)){ console.log(\"Number is either 1 or 2.\"); // comment } Example markdown {{\u003c figure src=\"kitten.jpg\" \u003e}} [example](https://example.org \"An example\") \u003c!-- comment --\u003e toml [params] bool = true # comment string ","categories":["test_category"],"description":"테스트 포스트 3\n","excerpt":"테스트 포스트 3\n","ref":"/test/test_post_3/","tags":["test_tag"],"title":"code snippet 테스트"},{"body":"","categories":["test_category"],"description":"테스트 포스트 4 show/hide\n","excerpt":"테스트 포스트 4 show/hide\n","ref":"/test/test_post_4/","tags":["test_tag"],"title":"hide 테스트"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/","tags":"","title":"Categories"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/","tags":"","title":"Tags"},{"body":"","categories":"","description":"","excerpt":"","ref":"/categories/test_category/","tags":"","title":"Test_category"},{"body":"","categories":"","description":"","excerpt":"","ref":"/tags/test_tag/","tags":"","title":"Test_tag"}]